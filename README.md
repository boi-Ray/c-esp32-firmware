# ESP32 韌體練習專案（C 語言 & FreeRTOS）

嗨，我是 Ray，這個專案是我在學習 ESP32 韌體開發過程中，針對幾個重要主題進行的實作練習。  
由於目前尚無相關工作經歷，因此我希望透過這份作品展示我在 **C 語言基礎、硬體控制、RTOS 任務管理** 方面的能力與學習成果。

所有程式均使用 C 語言撰寫，搭配 [ESP-IDF](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/) 框架開發，目標為模擬實際韌體開發中會遇到的問題並提出解決方案。

---

## 題目簡介

### 1. 自行實作 `memcpy` 並了解原理
**目標：**  
熟悉標準 C 函式的行為與記憶體操作原理。  
**內容：**  
在 `components/` 資料夾中自建一個元件（例如 `my_memcpy`），自行實作 `memcpy` 。  
**實作檔案：**  
c-esp32-firmware/practice_memcpy/my_memcpy.c

---

### 2. UART 指令控制 LED（使用 UART 接收緩衝）
**目標：**  
學習如何透過 UART 接收文字指令，解析後控制硬體（此處為 LED）。  
**內容：**  
- 持續接收使用者輸入的字串（例如 LED ON / LED OFF） 
- 當接收到換行符號（'\n' 或 '\r'）時觸發指令解析  
- 根據字串內容控制 GPIO2（開關 LED）

**實作檔案：**
  UART-test/main.c

---

### 3. FreeRTOS 任務排程（多任務 + 事件同步） 
**目標：**  
練習 FreeRTOS 任務建立、事件同步，以及任務間狀態傳遞，整合硬體輸出與使用者輸入互動。

**功能說明：**  
此範例建立三個任務，實作按鈕控制 LED 閃爍頻率，並在 UART 輸出當前狀態。

| 任務名稱      | 說明 |
|---------------|------|
| `led_task`    | 根據當前狀態 `flash_state` 控制 LED 閃爍頻率 |
| `uart_task`   | 每次狀態改變時，在 UART 上輸出目前 LED 閃爍頻率 |
| `button_scan` | 偵測按鈕事件（GPIO0），每按一次切換一種閃爍模式，並通知 UART 任務 |

**使用技術：**
- FreeRTOS 多任務排程 (`xTaskCreate`)  
- 事件同步 (`xEventGroupSetBits`, `xEventGroupWaitBits`)  
- GPIO 控制與按鈕去彈跳  
- UART 資訊輸出

**實作檔案：**
  FreeRTOS_Exercises/main.c

---
### 4. 摩斯電碼解碼器：非同步按鍵輸入 + Morse Tree 解碼
**目標：**  
模擬實體打字機行為，使用一顆按鍵輸入摩斯電碼（Morse Code），並透過中斷與事件旗標解碼為文字。練習 FreeRTOS 中事件同步、Timer 中斷回呼、非同步任務溝通與資料結構運用。

**功能說明：** 
*1. 按鈕輸入與去彈跳處理*
- 使用 ESP32 的 `esp_timer` 每 10ms 掃描按鍵狀態。
- 實作軟體層去彈跳邏輯，有效避免按鈕雜訊干擾。
- 根據按壓與放開時間，自動判斷是點（`.`）或劃（`-`）輸入。

*2. Morse 密碼時間解析邏輯*
- 依照國際摩斯電碼的規則來設計輸入判定

| 條件               | 解釋         |
|--------------------|--------------|
| 按壓時間 < 300 ms   | 點（`.`）    |
| 按壓時間 ≥ 300 ms   | 劃（`-`）    |
| 鬆開後靜止 > 300 ms | 字元結束     |
| 鬆開後靜止 > 700 ms | 單字結束     |

*3. 事件驅動架構（基於 FreeRTOS Event Group*
- 使用 FreeRTOS 的事件旗標機制偵測輸入事件：
  - `EVENT_DOT`：接收到點（`.`）
  - `EVENT_DASH`：接收到劃（`-`）
  - `EVENT_char_space`：完成一個字元
  - `EVENT_WORD_space`：完成一個單字
- 解碼任務獨立運行於 FreeRTOS task 中，確保即時性與解耦。

*4. 摩斯密碼解碼二元樹*
- 建構一棵摩斯碼二元樹：
  - `.` 走訪左子樹，`-` 走訪右子樹
  - 對應所有英文字母（A–Z）、數字（0–9）與常見標點符號（如 `.`, `?`, `@`）
- 使用者輸入的符號將即時解析並轉換為對應字元。

*5. 輸出與結果顯示*
- 每輸入一個字元或單字，系統會即時將對應的解碼結果透過序列埠 (`printf`) 顯示。
- 範例輸出如下：
  ...  => S , 1  // => 解碼結果,字元數量
  ---  => O , 2
  ...  => S , 3
  SOS            //當鬆開後靜止 > 700 ms時組合成單字並輸出

---

## 🔧 技術總結

這份專案涵蓋以下主題：

- C 語言函式實作與優化
- UART 基本輸入解析
- GPIO 控制與中斷處理
- FreeRTOS 任務與事件旗標應用
- Timer 中斷與非同步任務協作
- Morse Code Tree 演算法與資料結構整合

---

## 👋 想說的話

感謝您花時間閱讀這份作品。我相信韌體開發是一個很需要「解決問題能力」與「實作細節掌握」的領域，而我正是透過這樣的練習，不斷提升自己的技術。

如果您對這些內容感興趣，或願意給我一個學習與貢獻的機會，非常期待有機會與您聊聊 🙌
